const fs = require('fs');
const parser = require("@babel/parser");
const traverse = require("@babel/traverse").default;
const types = require("@babel/types");
const {assertArray} = require("@babel/core/lib/config/validation/option-assertions");
const generator = require("@babel/generator").default;

const log = console.log;
console.log = function () {
    let args = [(new Date).toLocaleString("zh").replaceAll("/", "-") + "     | INFO     | __main__:subprocess:** - ", ...arguments];
    log.apply(this, args)
};


//js混淆代码读取
Date.prototype.Format = function (fmt) {
    var o = {
        "M+": this.getMonth() + 1, //月份
        "d+": this.getDate(), //日
        "H+": this.getHours(), //小时
        "m+": this.getMinutes(), //分
        "s+": this.getSeconds(), //秒
        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
        "S": this.getMilliseconds() //毫秒
    };
    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
    for (var k in o)
        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
    return fmt;
};
let path = "./code/" + new Date().Format("yyyy-MM-dd") + "/test";
path = "./input";
encodeFile = process.argv.length > 2 ? process.argv[2] : path + "/sourceCode.js";
decodeFile = process.argv.length > 3 ? process.argv[3] : path + "/decodeResult.js";
tempDataFile = process.argv.length > 4 ? process.argv[4] : path + "/tempData.js";


const sourceCode = fs.readFileSync(encodeFile, {encoding: "utf-8"});
let code = sourceCode;
let ast = parser.parse(code);


code = generator(ast, opts = {}).code;
ast = parser.parse(code);
const constantFold =
    {
        "BinaryExpression|UnaryExpression"(path) {
            if (path.isUnaryExpression({operator: "-"}) ||
                path.isUnaryExpression({operator: "void"})) {
                return;
            }
            const {confident, value} = path.evaluate();
            if (!confident || value === "Infinity") return;
            globalThis.Replace = true;
            path.replaceWith(types.valueToNode(value));
            path.scope.crawl()

        },
    };
const restoreConstant =
    {
        VariableDeclarator(path) {
            // console.log("VariableDeclarator: ==> ", path.toString());
            let {node, scope} = path;
            let {id, init} = node;
            if (!types.isIdentifier(id) || init === null) return;
            if (types.isUnaryExpression(init) && ["+", "-", "*", "/"].includes(init.operator)) {
                if (!types.isLiteral(init.argument)) return;
            } else if (types.isIdentifier(init)) {
                if (typeof globalThis[init.name] === "undefined") return;
            } else if (types.isMemberExpression(init)) {
                let name = init.object.name;
                if (typeof globalThis[name] === "undefined" || name === "window") return;
            } else if (!types.isLiteral(init)) return;

            const binding = scope.getBinding(id.name);
            if (!binding || !binding.constant) return;

            for (let referPath of binding.referencePaths) {
                referPath.replaceWith(init)
            }
            path.remove()
        },
        AssignmentExpression(path) {
            // console.log("AssignmentExpression: ==> ", path.toString());
            let {scope, node, parentPath} = path;
            let {left, operator, right} = node;
            if (!types.isIdentifier(left) || operator !== "=") return;
            if (types.isUnaryExpression(right) && ["+", "-", "*", "/"].includes(right.operator)) {
                if (!types.isLiteral(right.argument)) return;
            } else if (types.isIdentifier(right)) {
                if (typeof globalThis[right.name] === "undefined") return;
            } else if (types.isMemberExpression(right)) {
                let name = right.object.name;
                if (typeof globalThis[name] === "undefined" || name === "window") return;
            } else if (!types.isLiteral(right)) return;

            let binding = scope.getBinding(left.name);
            if (!binding || binding.constantViolations.length !== 1) return;

            // 条件性修改变量值的语句不做还原
            // binding.path.parentPath.container.find(node => ["IfStatement", "TryStatement"].includes(node.type))
            if (binding.constantViolations[0].contexts.length > 1) {
                console.log("不符合替换规则: ", left.name);
                return
            }

            for (let referPath of binding.referencePaths.reverse()) {
                referPath.replaceWith(right)
            }
            if (parentPath.isExpressionStatement() || parentPath.isSequenceExpression()) {
                path.remove()
            }
        }
    };
// let count = 0;
// let lastcode = "", thiscode = code;
// while (count++ < 30 30&& lastcode !== thiscode) {
//     console.log("还原次数：", count);
//     traverse(ast, restoreConstant)
//     traverse(ast, constantFold)
//     code = generator(ast, opts = {}).code;
//     ast = parser.parse(code);
//     lastcode = thiscode
//     thiscode = code
// }


const _x2Num = {
    NumericLiteral(path) {
        let {node} = path;
        if (!(node.extra && node.extra.raw)){
            return
        }
        if (node.value.toString() !== node.extra.raw){
            path.replaceWith(types.NumericLiteral(node.value))
        }
    }
}

// traverse(ast, _x2Num)

let dic = {};
let funcs = {};
aaa = {"_0x247826(1678, 168, 1637, -783)":"11|7|10|5|","_0x247826(5042, 1799, 2898, 1478)":"8|0|12|4|6","_0x247826(1122, 3513, 2969, 3037)":"|2|1","_0x22e3e1(2100, 667, 2508, 1239)":"16|3|6|15|","_0x22e3e1(-243, 1399, 518, 2981)":"7|1|9|14|1","_0x22e3e1(-29, 2642, 1781, -106)":"9|12|4|8|0","_0x247826(-863, -2416, -194, 1218)":"|2|11|10|5","_0x22e3e1(3516, 4797, 2788, 1473)":"bDUuf","_0x247826(1024, 2096, 1707, 3110)":"0|8|7|3|1|","_0x247826(5684, 4966, 4104, 3842)":"6|5|4|9|10","_0x22e3e1(3288, 4804, 3490, 2527)":"5|4|7","_0x22e3e1(485, 1317, 97, -1245)":"4|2|3|0|1","_0x247826(4219, 5415, 3594, 1384)":"uwQSZ","_0x22e3e1(1158, 3303, 3150, 2396)":"QAMkD","_0x247826(6665, 6278, 4183, 3288)":"4|7|1|9|2|","_0x22e3e1(1096, 2602, 2270, 4093)":"4|0|3|6|5|","_0x22e3e1(4615, 4824, 4397, 3501)":"1|2","_0x22e3e1(2331, 5121, 4299, 1819)":"ndBUx","_0x247826(2456, 855, 3162, 3842)":"mDRiQ","_0x247826(1826, 2367, 2796, 1304)":"fwVbY","_0x22e3e1(1640, 1252, 415, -486)":"mMYyH","_0x22e3e1(6117, 4046, 3694, 2984)":"bXDpi","_0x247826(3196, 4945, 3770, 1999)":"2|0|7|8|3|","_0x22e3e1(-1985, -1451, 352, -438)":"EoGHH","_0x22e3e1(2867, 3747, 2469, 3847)":"0|7|9|2|1|","_0x22e3e1(646, 2761, 2008, 3069)":"17|19|2|0|","_0x22e3e1(2130, 5062, 4425, 4084)":"25|6|22|11","_0x22e3e1(2188, 4219, 1906, 1347)":"5|1|18|12|","_0x247826(3064, 3944, 2127, 2879)":"15|9|24|4|","_0x22e3e1(4474, 7158, 4752, 5808)":"14|3|20|16","_0x247826(1985, -999, -205, 1156)":"|7|13|8","_0x247826(-2348, 779, -338, 1172)":"4|3|0|2|1","_0x22e3e1(1564, 2057, 1990, 9)":"4|5|10|8|1","_0x22e3e1(6651, 3814, 4448, 6227)":"4|1|5|0|2|","_0x247826(1322, 5645, 3534, 4562)":"6|3","_0x247826(685, -17, 701, -781)":"{}.constru","_0x22e3e1(5082, 2126, 3926, 2105)":"ctor(\"retu","_0x22e3e1(1988, 3269, 3625, 2079)":"rn this\")(","_0x22e3e1(2305, 5506, 3935, 5219)":"function *","_0x22e3e1(3350, -478, 876, 1566)":"\\( *\\)","_0x22e3e1(2775, 567, 1852, 3144)":"\\+\\+ *(?:[","_0x22e3e1(5198, 4561, 3617, 3300)":"$]*)","_0x247826(3778, 3617, 2212, 936)":"chain","_0x22e3e1(2752, 921, 1864, 3254)":"8|17|13|9|","_0x247826(5, -556, 199, 2599)":"2|15|7|4|1","_0x22e3e1(2882, -15, 1394, -207)":"6|18|14|3","_0x22e3e1(2483, 5081, 4901, 3123)":"replac","_0x247826(-1429, 3086, 665, 2394)":"odeA","_0x247826(3709, 5278, 3574, 6034)":"fromCh","_0x22e3e1(-947, 1997, 1069, -1274)":"arCode","_0x247826(5875, 4266, 3734, 4514)":"Code","_0x22e3e1(1086, 3460, 1681, 2842)":"arCod","_0x22e3e1(3006, 5009, 4138, 5961)":"harCo","_0x247826(199, 2356, 2165, 3480)":"length","_0x22e3e1(2962, 472, 615, -1113)":"odeAt","_0x22e3e1(1600, 6235, 3897, 1496)":"canvas","_0x22e3e1(4008, 1725, 2615, 1652)":"rCase","_0x22e3e1(2573, -206, 1739, 2837)":"toLowe","_0x247826(3650, 3805, 1728, 1601)":"ned","_0x247826(3001, 211, 2383, 1863)":"unde","_0x22e3e1(754, -1514, 600, -1280)":"ined","_0x22e3e1(-639, 1821, 673, 2772)":"boolea","_0x247826(-1414, -2238, 238, 2644)":"YzprJ","_0x247826(4383, 2602, 2472, 1981)":"pApNt","_0x247826(148, 16, 2481, 3567)":"tYsdX","_0x22e3e1(1295, -1346, 877, -278)":"UPKRx","_0x247826(1597, 366, 2471, 3395)":"lKoKB","_0x22e3e1(2799, 3172, 4283, 6206)":"WvSsJ","_0x247826(5507, 3351, 4167, 2061)":"KwlXh","_0x22e3e1(1988, 4700, 2785, 2133)":"hfncR","_0x247826(1815, 1417, 3464, 1900)":"PkjFx","_0x22e3e1(3426, 5033, 3209, 2830)":"tvLyj","_0x22e3e1(-994, -1944, 539, 1365)":"vEKpN","_0x247826(2878, 5666, 3569, 4131)":"PBnzp","_0x22e3e1(118, 2745, 1596, 3874)":"ANsoQ","_0x22e3e1(2019, 2230, 3065, 589)":"xdONR","_0x247826(2164, 2537, 3475, 3050)":"NFUks","_0x247826(2803, 1792, 342, 2791)":"iJUWw","_0x247826(3067, 479, 871, 2360)":"NsOFS","_0x22e3e1(5232, 707, 2857, 4194)":"Char","_0x247826(3623, 4280, 2510, 3308)":"EbDFX","_0x247826(1031, 2273, 2787, 3282)":"fromC","_0x247826(2067, -464, 261, 32)":"harCod","_0x22e3e1(1318, 1305, 524, -1360)":"substr","_0x22e3e1(2154, 1807, 1943, 2579)":"nUBmp","_0x247826(446, -1458, 215, -1364)":"TEnaa","_0x22e3e1(3270, 993, 3128, 5303)":"CCvod","_0x247826(705, 53, 174, 1161)":"pjSCw","_0x247826(4397, 3329, 2020, 4325)":"create","_0x247826(6155, 2543, 3901, 4341)":"fTcYT","_0x247826(2014, 1375, 988, 2016)":"undefi","_0x22e3e1(-627, -7, 293, 886)":"CxyGJ","_0x247826(3940, 2983, 1811, 1418)":"mUJaV","_0x22e3e1(2112, 6947, 4503, 6086)":"mThoe","_0x247826(-127, -2444, -240, -342)":"fine","_0x22e3e1(5604, 5523, 3624, 3752)":"undef","_0x22e3e1(4004, 4642, 4518, 5737)":"hmmRJ","_0x59709d(1432, 678, 925, 583)":"YNcPx","_0x400afd(718, -1929, 1111, -66)":"jhfZS","_0x1e413f(2926, 1596, 2156, 2473)":"YNcPx","_0x7d4f28(3804, 2975, 3072, 2846)":"BtXYl","_0x400afd(611, 847, 2439, 1259)":"TfiUl","_0x400afd(2695, 3210, 2618, 795)":"AhnGs","_0x4506d0(2790, 795, -1032, 1391)":"split","_0x400afd(4301, 4237, 5838, 3994)":"CwrMS","_0x346533(2316, 1469, 2594, 3262)":"ZTobd","_0x346533(2662, 6329, 4945, 5086)":"ZEasI","_0x578e36(-185, 2346, 1865, 1325)":"RHAEX","_0x4506d0(6174, 4735, 5475, 2353)":"kLrJP","_0x400afd(2758, 2643, 987, 2272)":"SvBBl","_0x4506d0(-754, 795, 2239, -797)":"split","_0x400afd(678, -29, -1657, 494)":"AgEyT","_0x400afd(2723, 2341, 1655, 3221)":"glokt","_0x4506d0(2601, 4270, 5631, 2266)":"SPDMc","_0x54b35d(843, 1025, 2097, 3551)":"cBFoF","_0x25e32e(6122, 4392, 5669, 5286)":"1|0|8|7|6|","_0x31806f(4575, 740, 4552, 2961)":"4|5|2|3|9","_0x24eac8(-261, 1534, -742, 1838)":"uuVns","_0x45e768(-1294, 1680, 497, 852)":"EykuY","_0x25e32e(5514, 5487, 5209, 3500)":"gIdLt","_0x31806f(2015, 3334, 3786, 1710)":"TnRGD","_0x25e32e(4375, 3797, 86, 2388)":"aCGDr","_0x25e32e(1631, 3514, 1440, 3020)":"GAcsk","_0x31806f(3170, 2031, 3582, 4329)":"uXLqp","_0x25e32e(4026, 4370, 2464, 4549)":"uHFkK","_0x31806f(2394, 3121, 3914, 3346)":"SYdXi","_0x25e32e(3839, 4395, 2965, 3445)":"SYdXi","_0x25e32e(4778, 2354, 4822, 3445)":"SYdXi","_0x25e32e(533, 72, -1049, 1050)":"ytTfn","_0x31806f(7692, 3468, 6209, 5503)":"EzNJy","_0x31806f(1281, 3113, 4226, 1761)":"CSwxG","_0x25e32e(389, 1037, 3402, 1833)":"ttqHj","_0x31806f(3484, 8106, 5183, 5670)":"hKykv","_0x31806f(2965, 1758, 2152, 1761)":"CSwxG","_0x31806f(4473, 774, 2122, 2634)":"ysuzK","_0x25e32e(4080, 1693, 1523, 2129)":"GtpjK","_0x31806f(998, 1414, 634, 2009)":"MtNAh","_0x31806f(4088, 429, 4337, 2541)":"kKLrq","_0x31806f(910, 3395, 2839, 1739)":"xuwSi","_0x31806f(2532, 1370, -65, 1289)":"EykuY","_0x25e32e(3845, 7087, 2929, 4599)":"TzVwI","_0x25e32e(2782, 1031, 2426, 3056)":"vAcAt","_0x31806f(6140, 3388, 1395, 3790)":"eiRBT","_0x31806f(616, 2624, 2384, 1161)":"fsDtt","_0x31806f(3251, 5300, 3140, 3556)":"Fglaz","_0x31806f(2675, -394, -775, 951)":"ytTfn","_0x31806f(3236, 769, 1181, 2030)":"GtpjK","_0x31806f(2451, 1755, 775, 3194)":"URFUO","_0x25e32e(5313, 7758, 6861, 5769)":"hKykv","_0x31806f(1480, 1713, 3604, 2009)":"MtNAh","_0x31806f(2002, -517, 2997, 1128)":"ioWlT","_0x31806f(-663, 2604, 2280, 1128)":"ioWlT","_0x25e32e(890, 3837, 938, 3010)":"OdZPs","_0x25e32e(5096, 1706, 1674, 2998)":"ZsInr","_0x31806f(4001, 706, -408, 1506)":"split","_0x25e32e(1044, 187, 849, 2623)":"wsdGZ","_0x25e32e(5229, 3104, 6725, 5467)":"ZrQvx","_0x31806f(6188, 3176, 3423, 5368)":"ZrQvx","_0x25e32e(-284, 2202, -1112, 1050)":"ytTfn","_0x25e32e(5907, 6695, 7210, 5769)":"hKykv","_0x25e32e(2900, 4979, 5177, 3889)":"eiRBT","_0x25e32e(1883, 1149, 4051, 1961)":"OAALD","_0x31806f(3562, 8120, 6953, 5670)":"hKykv","_0x31806f(4950, 2960, 2544, 4038)":"UtYmp","_0x25e32e(2698, 5235, 5554, 3293)":"URFUO","_0x31806f(3769, 1494, 1232, 2634)":"ysuzK","_0x31806f(2232, 2454, 2982, 2541)":"kKLrq","_0x25e32e(-36, 33, -276, 2176)":"QlFaE","_0x31806f(3694, 3127, -183, 2042)":"BLwDg","_0x2a5667(1312, 2595, 2692, 2351)":"iPYGR","_0x3da37b(2023, 4027, 2390, 3282)":"iPYGR","_0x2a5667(6207, 5460, 4892, 4999)":"iaeer","_0x3da37b(1351, 3833, 2022, 1527)":"split","_0x2a5667(4294, 3640, 2556, 1651)":"BLwDg","_0x3da37b(5262, 4531, 6997, 4897)":"dYkXq","_0x3da37b(4225, 5795, 6511, 3962)":"RuDrC","_0x2a5667(5019, 4767, 2692, 2269)":"iPYGR","_0x5d4c27(6791, 5630, 4669, 5486)":"4|0|1|3|9|","_0x5d4c27(335, -1642, 714, -910)":"5|2|7|6|8","_0x5d4c27(3102, 2743, 2466, 3679)":"lopdJ","_0x23df24(980, 1367, 3354, 335)":"fsDtt","_0x45db78(3549, 2515, 2648, 2782)":"QhnYa","_0x45db78(2562, 1637, 1606, 429)":"split","_0x402fb1(954, 2502, 285, 3726)":"lopdJ","_0x402fb1(-484, 619, -120, 2463)":"mrtqu","_0x5c861c(2785, 4963, 4898, 4020)":"YeBNo","_0x5c861c(1214, 385, -225, 978)":"split","_0x273345(1819, 1140, 3127, -276)":"MtNAh","_0x3faad0(-467, 2051, 2106, 763)":"3|7|4|6|1|","_0xe65eed(744, 2081, -39, -360)":"5|0|2","_0xe65eed(508, 2011, 1539, 3116)":"split","_0x3faad0(6211, 2872, 4180, 5057)":"YMExV","_0x39c677(4265, 5565, 3229, 1523)":"NbPtU","_0x39c677(2109, 3614, 1916, 1529)":"wsdGZ","_0x39c677(4778, 2590, 3895, 3170)":"EvdGL","_0x1fb22b(5978, 6838, 5302, 6147)":"ikGjz","_0x4b55d6(8086, 5705, 7752, 3695)":"ikGjz","_0x1fb22b(3820, 2997, 5267, 3825)":"VzNIw","_0x322dbb(3623, 2457, 550, 1938)":"OmGbm","_0x322dbb(2539, 4147, 1895, 5820)":"bxNYD","_0x4549aa(1174, 2507, 1941, 1046)":"POzKW","_0x322dbb(6026, 5124, 6209, 6178)":"ikGjz","_0x4549aa(2554, 2870, 384, 1592)":"7|3|6","_0x4549aa(1121, 2625, 581, 2916)":"Fglaz","_0x331f82(4961, 7204, 4440, 5526)":"PjKIy","_0x331f82(2536, 2006, 3884, 4089)":"FzeDg","_0x40c0c0(7445, 5662, 5057, 2653)":"LtTEv","_0x40c0c0(1813, 625, 3036, 2493)":"qWqUR","_0x331f82(5101, 6481, 4106, 4697)":"EvdGL","_0x40c0c0(4145, 1598, 2565, 4331)":"Lbeet","_0x331f82(5962, 5244, 7589, 6020)":"ikGjz","_0x331f82(5962, 7213, 5382, 7289)":"ikGjz","_0x331f82(4961, 3657, 2501, 4269)":"PjKIy","_0x59aa9f(-445, 1786, 550, -250)":"YNcPx","_0x4c8694(5261, 2825, 3708, 3673)":"Cuyts","_0x4199b1(1918, 2563, 927, -170)":"glxZM","_0x4c8694(4491, 4013, 2180, 2800)":"bSizg","_0x4199b1(-1322, 2911, 434, 1616)":"yXudq","_0x4199b1(866, 926, 2113, 3586)":"length","_0x4199b1(3796, 3324, 1958, 1618)":"BtXYl","_0x4c8694(4889, 2452, 4767, 4762)":"qhWlf","_0x4199b1(97, 594, 2395, 4412)":"PNdAC","_0x4c8694(889, 2556, 2283, 4883)":"NZNrg","_0x4199b1(3635, 2028, 2830, 3743)":"Xzywa","_0x4199b1(3787, 3812, 4116, 2743)":"eXFxk","_0x4199b1(1304, 2732, 3344, 2489)":"zIkSK","_0x4c8694(1072, 2556, 2688, 1598)":"NZNrg","_0x4199b1(-356, 656, 868, 2458)":"NZNrg","_0x4199b1(2248, -28, -153, -1650)":"RnPUG","_0x4199b1(4961, 3195, 2573, 419)":"eiRBT","_0x4c8694(5297, 4097, 4913, 2481)":"feMJv","_0x4199b1(1362, 1196, -126, -42)":"Tqgnu","_0x4c8694(-89, 2073, 847, 4057)":"0|4|3|2|1|","_0x4c8694(3893, 2512, 184, 2573)":"ZWxVX","_0x4c8694(4697, 2556, 536, 647)":"NZNrg","_0x4c8694(3529, 2556, 2637, 2305)":"NZNrg","_0x4c8694(5803, 4051, 6159, 5339)":"nNOAQ","_0x4199b1(2020, 1412, 3764, 2575)":"SPDMc","_0x674f99(1332, 999, -657, 1867)":"VuHFF","_0x2a544a(2868, 2717, 4117, 1901)":"BtXYl","_0x26d3b3(563, 3472, 2880, 5152)":"qWqUR","_0x11ce5d(3655, 1393, -216, 1434)":"uuVns","_0x314c70(4579, 8297, 4299, 5946)":"qiFnh","_0x674f99(2887, 4604, 5018, 6956)":"qiFnh","_0x131757(3148, 1103, 3464, 1229)":"orDVI","_0x131757(489, 1868, 1220, -435)":"PrNwy","_0x15ab92(3777, 4033, 3886, 3921)":"ZDdxX","_0x131757(2933, 3528, 1417, 1258)":"UmcjH","_0x314c70(746, 811, 3118, 2746)":"uuDqz","_0x314c70(3413, 4163, 1696, 1847)":"split","_0x674f99(5269, 3204, 2690, 2593)":"tkMwn","_0x314c70(1698, 3090, 2076, 3194)":"Ordib","_0x314c70(2676, 2597, 2181, 3262)":"GAcsk","_0x674f99(2318, 2502, 1561, 557)":"ksztI","_0x22a4e2(3230, 4536, 3062, 4637)":"nouEf","_0x22a4e2(-1912, -341, -970, 575)":"split","_0x472fc4(3470, 3047, 2723, 5409)":"length","_0x22a4e2(1908, 4886, 4262, 2625)":"Fglaz","_0x472fc4(5633, 3506, 5390, 5623)":"dnsjB","_0x472fc4(3482, 3506, 2520, 3002)":"dnsjB","_0x22a4e2(2796, 2275, 2065, 1348)":"skrud","_0x472fc4(1582, 2112, 845, 165)":"YNPri","_0x22a4e2(1476, -934, -2227, 160)":"Tqgnu","_0x472fc4(4652, 3273, 4308, 3949)":"Fglaz","_0x22a4e2(2125, 2861, 78, 2244)":"BtXYl","_0x22a4e2(2669, 2505, 2343, 4094)":"SVxwz","_0x472fc4(5086, 4882, 4478, 2554)":"YICGJ","_0x22a4e2(-221, -416, -365, 1348)":"skrud","_0x22a4e2(3237, 716, -30, 1274)":"TQSOo","_0x472fc4(2357, 3563, 5031, 4041)":"ZBdVR","_0x22a4e2(413, 1754, -1289, 56)":"cGWEI","_0x472fc4(2679, 1451, 2489, -415)":"ttqHj","_0x22a4e2(1787, 5163, 5115, 3398)":"uXLqp","_0x472fc4(1110, 2769, 1441, 1328)":"DeIOE","_0x22a4e2(-2204, -1365, 2108, 63)":"VjHLf","_0x247826(1472, 1429, 2010, 3021)":"BtXYl","_0x22e3e1(5722, 1371, 3354, 3165)":"IFWNx","_0x22e3e1(2312, 4251, 1958, 3853)":"cBFoF","_0x247826(460, 3637, 1526, 2861)":"wAVTe","_0x22e3e1(160, -308, 1277, 3003)":"eYmzg","_0x22e3e1(-761, 2305, 818, -114)":"split","_0x22e3e1(-610, -179, 606, 806)":"KfiTs","_0x22e3e1(5394, 4772, 4018, 4383)":"yRuKk","_0x247826(2175, 1713, 1790, 3948)":"hbxJj","_0x247826(1120, 2545, 3589, 2756)":"27|24|2|16","_0x247826(4879, 3148, 3352, 4697)":"|31|33|25|","_0x22e3e1(1307, -688, 81, 475)":"21|7|8|19|","_0x22e3e1(5179, 5105, 4711, 3279)":"11|3|28|23","_0x22e3e1(3892, 2311, 4255, 3100)":"|13|14|0|1","_0x247826(595, 1615, 341, 2401)":"split","_0x22e3e1(2127, 3556, 1867, 3064)":"HvYQY","_0x22e3e1(5715, 3151, 3849, 1793)":"LqiwD","_0x22e3e1(2938, 2447, 877, 57)":"UPKRx","_0x22e3e1(2751, 4421, 2487, 839)":"BtXYl","_0x22e3e1(3876, 4075, 2009, 2727)":"OmGbm","_0x22e3e1(364, 3028, 1196, -814)":"uuVns","_0x247826(2979, 6051, 4112, 3383)":"VOzjJ","_0x247826(5045, 4940, 4112, 2718)":"VOzjJ","_0x247826(2123, 3501, 1532, 528)":"OmGbm","_0x22e3e1(3570, 1949, 2401, 3926)":"PjheM","_0x247826(2272, -209, 1924, 3281)":"PjheM","_0x22e3e1(4454, 3233, 2940, 2446)":"vyGFe","_0x22e3e1(-962, 1815, 818, -385)":"split","_0x247826(145, 602, 1555, 1545)":"CiKgy","_0x247826(-506, 582, 1384, 455)":"qWqUR","_0x22e3e1(6461, 6016, 4345, 2177)":"bUFSv","_0x22e3e1(1794, 2320, 3762, 5717)":"uHFkK","_0x22e3e1(-379, 1077, 1666, 3014)":"Cuyts","_0x22e3e1(3690, 4759, 3927, 2627)":"shLhl","_0x247826(1724, 99, 1083, 2799)":"vkiei","_0x247826(4766, 827, 2665, 3694)":"Jgtjj","_0x22e3e1(2256, 5644, 3937, 5486)":"bvKBy","_0x3df03d(1215, 5959, 3649, 1312)":"Jgtjj","_0x3df03d(911, 1053, 1325, 334)":"split","_0x247826(-73, -458, 1532, 3849)":"OmGbm","_0x22e3e1(2367, -61, 601, -558)":"EykuY","_0x247826(4129, 619, 2234, 1126)":"VQcqi","_0x22e3e1(2060, 999, 3308, 2590)":"EPkBW","_0x22e3e1(1987, 1992, 1012, 254)":"HypGa","_0x247826(1058, 173, 2149, 1762)":"return (fu","_0x247826(2070, 3275, 1886, 2221)":"nction() ","_0x22e3e1(-800, 1742, 1076, 993)":"VrUqx","_0x247826(1119, 4521, 3198, 3449)":"PjKIy","_0x22e3e1(5398, 4212, 3675, 5029)":"PjKIy","_0x247826(4122, -96, 1775, 718)":"aLyaj","_0x22e3e1(-105, -133, 1196, -1076)":"uuVns","_0x22e3e1(4532, 3406, 4463, 5225)":"kELwq","_0x22e3e1(1075, -1682, 383, -747)":"EXEEj","_0x247826(-1972, 661, 304, 2713)":"QQQxR","_0x247826(2604, 239, 2581, 3576)":"test","_0x22e3e1(-585, 128, 1279, 3260)":"DMYNu","_0x22e3e1(4921, 4217, 3058, 811)":"test","_0x22e3e1(1833, 824, 2032, 2078)":"CiKgy","_0x22e3e1(4145, 3777, 1731, 2035)":"input","_0x22e3e1(3890, 2465, 3159, 4604)":"zPIQf","_0x22e3e1(2858, 5070, 3729, 3151)":"vqWTc","_0x22e3e1(391, 2534, 1596, -727)":"ANsoQ","_0x22e3e1(1894, 1014, 216, -76)":"tSZcT","_0x247826(5102, 5178, 4020, 1780)":"RXgZE","_0x247826(5082, 5626, 4149, 3395)":"bJZbL","_0x22e3e1(1222, 4227, 2318, 138)":"vVkDB","_0x247826(2122, -1989, -266, 949)":"MggWa","_0x22e3e1(2551, -1969, 211, -128)":"MggWa","_0x22e3e1(197, 1274, 2032, 249)":"CiKgy","_0x22e3e1(565, 2233, 2487, 2481)":"BtXYl","_0x22e3e1(1367, -74, 1196, 2414)":"uuVns","_0x22e3e1(2449, 486, 2526, 1697)":"ouFwU","_0x22e3e1(-256, 358, 218, 1965)":"wXVVm","_0x22e3e1(2117, 2720, 2642, 236)":"length","_0x22e3e1(1347, -406, 1352, 1573)":"HJICv","_0x22e3e1(-885, -1144, 1270, 2861)":"TuvtR","_0x22e3e1(3435, 2047, 2672, 3215)":"mzgUC","_0x22e3e1(50, 2192, 993, -1239)":"YNcPx","_0x247826(549, 4465, 2195, 4495)":"mzgUC","_0x247826(4531, 892, 2625, 3984)":"eiRBT","_0x247826(2372, 4511, 4523, 4241)":"nPoxd","_0x22e3e1(203, 579, 211, -43)":"MggWa","_0x22e3e1(981, 1305, 2672, 4364)":"mzgUC","_0x247826(5983, 5692, 3640, 2494)":"NPqCx","_0x22e3e1(1746, 1580, 3817, 1766)":"JxJZH","_0x247826(1545, 3931, 3705, 4204)":"XfSZi","_0x22e3e1(2473, 2521, 801, 3109)":"PvNxs","_0x22e3e1(3037, 4847, 3817, 5999)":"JxJZH","_0x247826(3300, 1229, 2602, 5040)":"FvNAn","_0x22e3e1(3599, 2648, 4893, 4910)":"hiIPL","_0x247826(2261, 1740, 1941, 3470)":"ZlbQv","_0x247826(1703, 489, -292, 2140)":"nxANX","_0x22e3e1(4522, 1514, 3662, 3523)":"ZqjUY","_0x22e3e1(3446, 6567, 4976, 2541)":"KWoij","_0x247826(-1773, -912, 546, 691)":"YHXQr","_0x22e3e1(1295, 2350, 211, 543)":"MggWa","_0x22e3e1(-1009, 3499, 1455, 3810)":"HAnWh","_0x22e3e1(2093, 2175, 3495, 3096)":"JeRzm","_0x247826(2290, 1857, 1704, 1510)":"ONYLc","_0x247826(3864, 3668, 3705, 3460)":"XfSZi","_0x247826(1011, 466, 2120, 3249)":"uQidK","_0x247826(3379, 6068, 3705, 4436)":"XfSZi","_0x247826(-483, -1331, 231, -2205)":"ypSla","_0x247826(1009, 2619, 232, -7)":"qPwXq","_0x22e3e1(-541, 700, 471, 2112)":"LnwpZ","_0x247826(1977, 1927, 2061, 1193)":"pObsc","_0x22e3e1(1630, 2689, 1699, 832)":"GNIGD","_0x22e3e1(3428, 1992, 1517, -268)":"TQSOo","_0x22e3e1(4366, 2845, 2151, 2693)":"mCrWS","_0x22e3e1(4790, 408, 2418, 355)":"ZlbQv","_0x22e3e1(4597, 4278, 3332, 3629)":"EXayr","_0x247826(5444, 3596, 4340, 3331)":"imuCq","_0x247826(4531, 3221, 4057, 5215)":"aFgDn","_0x247826(2372, 3606, 3683, 3851)":"tIYcc","_0x247826(2383, 212, 1341, 1554)":"Emhnb","_0x22e3e1(3041, 3794, 3828, 4611)":"MrWCf","_0x247826(1121, 1996, 1610, 1742)":"DxucZ","_0x22e3e1(2327, 279, 634, 920)":"BTEDg","_0x247826(722, 1204, 2400, 2719)":"wzRZx","_0x22e3e1(3569, 3450, 1135, 2659)":"XQMCY","_0x247826(-610, 2416, 477, -625)":"PVpug","_0x22e3e1(2818, 3084, 4006, 3175)":"HvnaX","_0x22e3e1(2834, 4602, 4521, 3614)":"vCpwt","_0x247826(-1276, -389, 581, 2385)":"HjmcS","_0x22e3e1(2072, -422, 2032, 868)":"CiKgy","_0x247826(3596, 4240, 3340, 4488)":"JxJZH","_0x247826(2812, -310, 1390, 1931)":"HvYQY","_0x22e3e1(3142, 2533, 2403, 2405)":"PbdID","_0x247826(5192, 2490, 3351, 2638)":"MrWCf","_0x22e3e1(3390, 1654, 973, 1035)":"sCDid","_0x22e3e1(1416, 3049, 3719, 5548)":"Qcjfk","_0x22e3e1(3962, 6420, 4672, 5298)":"OjNvg","_0x22e3e1(2774, -625, 973, 1935)":"sCDid","_0x22e3e1(1392, 3211, 3662, 6063)":"ZqjUY","_0x22e3e1(2652, 25, 901, -784)":"NFCsq","_0x22e3e1(5053, 6308, 4124, 2649)":"XCwAJ","_0x247826(350, 1130, 546, -312)":"YHXQr","_0x22e3e1(4643, 4348, 3945, 4033)":"MBcKm","_0x22e3e1(302, 825, 2366, 4255)":"msCFM","_0x22e3e1(3772, 2832, 2518, 1071)":"VzNIw","_0x247826(4398, 3344, 4199, 2347)":"ikGjz","_0x247826(-252, 854, 913, 628)":"Lbeet","_0x22e3e1(2532, 1850, 1791, 418)":"NMRDR","_0x22e3e1(3018, 5213, 4492, 6446)":"qDkxG","_0x22e3e1(1500, 3600, 3939, 5370)":"knhaE","_0x22e3e1(-1215, 2153, 708, -105)":"ypSla","_0x247826(3137, 3089, 1314, 2703)":"NMRDR","_0x22e3e1(2705, 5240, 4626, 5604)":"bJZbL","_0x22e3e1(1287, -1071, 409, 2306)":"cmuss"}
const Ob = {
    CallExpression(path) {
        let {node, scope} = path;
        let {callee, arguments} = node;
        if (arguments.length !== 4)return;
        for (let i = 0; i < arguments.length; i++) {
            let argument = arguments[i];
            if (!(types.isNumericLiteral(argument) || types.isUnaryExpression(argument)))return;
        }
        dic[path.toString()] = "";
        let binding = scope.getBinding(callee.name);

        funcs[callee.name] = binding.path.toString()
        let value = aaa[path.toString()];
        if (!value)return;
        path.replaceWith(types.valueToNode(value))
    }
}
traverse(ast, Ob)

console.log(dic)

console.log(funcs)
console.timeEnd("处理完毕，耗时");


// let {code} = generator(ast, opts = {jsescOption: {"minimal": true}});
code = generator(ast, opts = {}).code;

fs.writeFile(decodeFile, code, (err) => {
    console.log("保存 decodeFile: ", err)
});